<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/jpg" href="pic/img2.jpg">
    <title>Er Nerr</title>
	<style>
        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
		#bg-video {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            min-width: 100vw; min-height: 100vh;
            max-width: 100vw; max-height: 100vh;
            object-fit: cover;
            object-position: center center;
            z-index: -1;
            pointer-events: none;
            background: #000;
        }
        @media (max-width: 600px) {
            #bg-video {
                width: 100vw;
                height: 100vh;
                min-width: 100vw;
                min-height: 100vh;
                object-fit: cover;
            }
            body {
                width: 100vw;
                height: 100vh;
                overflow: hidden;
            }
        }
		}
		/* Gộp và rút gọn CSS cho các nút */
#nut1, #nut2, #nut3 {
    position: absolute;
    right: unset;
    bottom: unset;
    left: 32px;
    top: 32px;
    /* Các nút sẽ bắt đầu ở vị trí khác nhau */
}
#nut2 { left: 32px; top: 112px; }
#nut3 { left: 32px; top: 192px; }
#nut1, #nut2, #nut3 {
    position: absolute;
    right: unset;
    bottom: unset;
    left: 32px;
    width: 180px;
    height: 64px;
    padding: 0 32px;
    background: rgba(255,255,255,0.6);
    color: #222;
    border: none;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
    font-size: 18px;
    cursor: pointer;
    backdrop-filter: blur(2px);
    display: flex;
    align-items: center;
    gap: 12px;
    user-select: none;
    z-index: 1000000;
    transition: box-shadow 0.2s, transform 0.15s;
}

#nut1:active, #nut2:active, #nut3:active {
    box-shadow: 0 1px 4px rgba(0,0,0,0.18);
    transform: scale(0.96);
    background: rgba(255,255,255,0.8);
}
#nut1 { top: 32px; }
#nut2 { top: 112px; }
#nut3 { top: 192px; }
#nut1 img, #nut2 img, #nut3 img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: transparent;
    pointer-events: none;
}
		/* Rút gọn CSS cho popup */
.popup {
    display: none;
    position: fixed;
    width: 300px;
    height: 400px;
    background: rgba(255,255,255,0.5);
    box-shadow: 0 4px 32px rgba(0,0,0,0.18);
    border-radius: 16px;
    z-index: 99999;
    backdrop-filter: blur(8px);
    overflow: hidden;
}
.popup-header {
    cursor: move;
    padding: 12px 16px;
    background: rgba(255,255,255,0.3);
    border-radius: 16px 16px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
    /* Căn giữa tiêu đề popup */
    .popup-title {
        font-size: 20px;
        color: #333;
        width: 100%;
        text-align: center;
        display: flex;
        justify-content: center;
        align-items: center;
    }
.popup-content {
    width: 100%;
    box-sizing: border-box;
    overflow-y: auto;
    overflow-x: hidden;
    max-height: calc(100% - 56px);
    display: block;
    text-align: center;
}
	</style>
</head>
<body>
	<video id="bg-video" autoplay loop muted playsinline preload="auto">
		<source src="video/b21.mp4" type="video/mp4">
		Trình duyệt của bạn không hỗ trợ video.
	</video>
	<!-- Nút -->
<button id="nut1">
        <img src="pic/dcl.png" alt="Discord">
        Discord
    </button>
    <button id="nut2">
        <img src="pic/tyf.png" alt="Youtube" style="width:28px; height:28px; border-radius:50%; background:transparent; pointer-events:none;">
        MXH
    </button>
    <button id="nut3">
        <img src="pic/Roblox.png" alt="Roblox" style="width:28px; height:28px; border-radius:50%; background:transparent; pointer-events:none;">
        Roblox
    </button>
	<button id="nut4" style="position:absolute; left:100px; top:100px; width:40px; height:40px; border-radius:50%; background:#eee; box-shadow:0 0 8px #aaa; cursor:pointer; z-index:1000; transition:width 0.38s, height 0.38s, left 0.3s, top 0.3s;">
    <img src="pic/phpls.png" alt="Hidden" style="width:100%; height:100%; border-radius:50%; pointer-events:none; user-select:none;">
</button>
	<!-- Popup -->
	<div id="cuaso1" class="popup" style="top:120px; left:120px;">
    <div id="custom-header" class="popup-header">
        <span id="custom-title" class="popup-title">13th / nerr</span>
        <div style="display:flex; gap:4px;">
            <button id="custom-min" title="Thu nhỏ" style="width:28px; height:28px; border:none; background:#eee; border-radius:50%; cursor:pointer; font-size:18px; font-weight:bold; display:flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #222;">●</button>
            <button id="custom-max" title="Mở rộng" style="width:28px; height:28px; border:none; background:#eee; border-radius:6px; cursor:pointer; font-size:18px; font-weight:bold; display:flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #222;">■</button>
        </div>
    </div>
    <div id="custom-content" class="popup-content">
        <a href="https://discordapp.com/users/1115398524805324941" target="_blank" style="color:#5865F2; text-decoration:none; display:flex; align-items:center; gap:8px; margin-bottom:12px;">
            <img src="pic/av2.png" alt="n13vjr" style="width:42px; height:42px; border-radius:50%; object-fit:cover; vertical-align:middle;">
            n13vjr
        </a>
        <a href="https://discordapp.com/users/982663978125758535" target="_blank" style="color:#5865F2; text-decoration:none; display:flex; align-items:center; gap:8px; margin-bottom:12px;">
            <img src="pic/av1.gif" alt="n13vjr_" style="width:42px; height:42px; border-radius:50%; object-fit:cover; vertical-align:middle;">
            n13vjr_
        </a>
        <a href="https://discord.gg/9pPNkKGxsq" target="_blank" style="color:#5865F2; text-decoration:none; display:flex; align-items:center; gap:8px; margin-bottom:12px;">
            <img src="pic/av3.gif" alt="13th" style="width:42px; height:42px; border-radius:50%; object-fit:cover; vertical-align:middle;">
            13th
        </a>
    </div>
    <!-- Xóa handle cũ, đã có handle mới tự động tạo -->
</div>
<div id="cuaso2" class="popup" style="top:180px; left:180px;">
    <div id="cuaso2-header" class="popup-header">
        <span id="cuaso2-title" class="popup-title">MẠNG XÃ HỘI</span>
        <div style="display:flex; gap:4px;">
            <button id="cuaso2-min" title="Thu nhỏ" style="width:28px; height:28px; border:none; background:#eee; border-radius:50%; cursor:pointer; font-size:18px; font-weight:bold; display:flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #222;">●</button>
            <button id="cuaso2-max" title="Mở rộng" style="width:28px; height:28px; border:none; background:#eee; border-radius:6px; cursor:pointer; font-size:18px; font-weight:bold; display:flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #222;">■</button>
        </div>
    </div>
    <div id="cuaso2-content" class="popup-content">
        <!-- Content 1: Youtube channel -->
            <a href="https://www.youtube.com/@n13vjr" target="_blank" style="display:flex; align-items:center; gap:10px; margin-bottom:16px; text-decoration:none; color:#ff0000;">
                <img src="pic/avyt.jpg" alt="Youtube" style="width:48px; height:48px; border-radius:12px; object-fit:cover;">
                <span style="font-size:20px; font-weight:bold;">n13vjr Youtube Channel</span>
            </a>
            <!-- Custom content: 2 dòng liên kết và hình ảnh -->
            <a href="https://www.tiktok.com/@n13vjr" target="_blank" style="display:flex; align-items:center; gap:10px; margin-bottom:12px; text-decoration:none; color:#b31de0;">
                <img src="pic/avtt.jpeg" alt="Tiktok" style="width:48px; height:48px; border-radius:12px; object-fit:cover;">
                <span style="font-size:18px; font-weight:bold;">n13vjr Tiktok Channel</span>
            </a>
            <a href="https://www.facebook.com/n13vjrr" target="_blank" style="display:flex; align-items:center; gap:10px; margin-bottom:12px; text-decoration:none; color:#0015ff;">
                <img src="pic/avfb.jpg" alt="Facebook" style="width:48px; height:48px; border-radius:12px; object-fit:cover;">
                <span style="font-size:18px; font-weight:bold;">n13vjr Facebook</span>
            </a>
    </div>
    <!-- Xóa handle cũ, đã có handle mới tự động tạo -->
</div>
<div id="cuaso3" class="popup" style="top:240px; left:240px;">
    <div id="cuaso3-header" class="popup-header">
        <span id="cuaso3-title" class="popup-title">My Roblox Accounts(21)</span>
        <div style="display:flex; gap:4px;">
            <button id="cuaso3-min" title="Thu nhỏ" style="width:28px; height:28px; border:none; background:#eee; border-radius:50%; cursor:pointer; font-size:18px; font-weight:bold; display:flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #222;">●</button>
            <button id="cuaso3-max" title="Mở rộng" style="width:28px; height:28px; border:none; background:#eee; border-radius:6px; cursor:pointer; font-size:18px; font-weight:bold; display:flex; align-items:center; justify-content:center; box-shadow:0 0 0 2px #222;">■</button>
        </div>
    </div>
    <div id="cuaso3-content" class="popup-content">
            <div><a href="https://www.roblox.com/users/3518420197/profile" target="_blank"><img src="pic/n13vjr.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 1:</b> n13vjr</div>
            <div><a href="https://www.roblox.com/users/4474878300/profile" target="_blank"><img src="pic/nerrnofriends.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 2:</b> nerrnofriends</div>
            <div><a href="https://www.roblox.com/users/7544319820/profile" target="_blank"><img src="pic/nerr239.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 3:</b> nerr239</div>
            <div><a href="https://www.roblox.com/users/7808611657/profile" target="_blank"><img src="pic/mynameisnerr.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 4:</b> mynameisnerr</div>
            <div><a href="https://www.roblox.com/users/7855889551/profile" target="_blank"><img src="pic/uhnerr.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 5:</b> sonerr</div>
            <div><a href="https://www.roblox.com/users/651536/profile" target="_blank"><img src="pic/robert488.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 6:</b> robert488</div>
            <div><a href="https://www.roblox.com/users/1626232/profile" target="_blank"><img src="pic/dip514.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 7:</b> dip514</div>
            <div><a href="https://www.roblox.com/users/1388501/profile" target="_blank"><img src="pic/Thedarkgunz.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 8:</b> TheDarkGunz</div>
            <div><a href="https://www.roblox.com/users/7682880452/profile" target="_blank"><img src="pic/n13vjr1.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 9:</b> n13vjr_1</div>
            <div><a href="https://www.roblox.com/users/7682888324/profile" target="_blank"><img src="pic/n13vjr2.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 10:</b> n13vjr_2</div>
            <div><a href="https://www.roblox.com/users/7682893720/profile" target="_blank"><img src="pic/n13vjr3.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 11:</b> n13vjr_3</div>
            <div><a href="https://www.roblox.com/users/7682898185/profile" target="_blank"><img src="pic/n13vjr4.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 12:</b> n13vjr_4</div>
            <div><a href="https://www.roblox.com/users/7682901117/profile" target="_blank"><img src="pic/n13vjr5.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 13:</b> n13vjr_5</div>
            <div><a href="https://www.roblox.com/users/7682901785/profile" target="_blank"><img src="pic/n13vjr6.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 14:</b> n13vjr_6</div>
            <div><a href="https://www.roblox.com/users/7682911530/profile" target="_blank"><img src="pic/n13vjr7.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 15:</b> n13vjr_7</div>
            <div><a href="https://www.roblox.com/users/7682909716/profile" target="_blank"><img src="pic/n13vjr8.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 16:</b> n13vjr_8</div>
            <div><a href="https://www.roblox.com/users/7682914046/profile" target="_blank"><img src="pic/n13vjr9.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 17:</b> n13vjr_9</div>
            <div><a href="https://www.roblox.com/users/7682909940/profile" target="_blank"><img src="pic/n13vjr10.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 18:</b> n13vjr_10</div>
            <div><a href="https://www.roblox.com/users/7682914236/profile" target="_blank"><img src="pic/n13vjr11.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 19:</b> n13vjr_11</div>
            <div><a href="https://www.roblox.com/users/7682913450/profile" target="_blank"><img src="pic/n13vjr12.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 20:</b> n13vjr_12</div>
            <div><a href="https://www.roblox.com/users/7682922659/profile" target="_blank"><img src="pic/n13vjr13.png" alt="avatar" style="width:32px; height:32px; border-radius:50%; margin-right:8px; vertical-align:middle;"></a> <b>Roblox Account 21:</b> n13vjr_13</div>
        </div>
    </div>
    <!-- Xóa handle cũ, đã có handle mới tự động tạo -->
</div>
	<!-- Thêm phần audio vào HTML -->
<audio id="nut4-audio" src="sound/wallet.mp3" preload="auto"></audio>
<!-- Thêm audio cho popup mở/tắt -->
<audio id="popup1-open-audio" src="sound/mo.wav" preload="auto"></audio>
<audio id="popup1-close-audio" src="sound/tat.wav" preload="auto"></audio>
<audio id="popup2-open-audio" src="sound/mo.wav" preload="auto"></audio>
<audio id="popup2-close-audio" src="sound/tat.wav" preload="auto"></audio>
<audio id="popup3-open-audio" src="sound/bt.mp3" preload="auto"></audio>
<audio id="popup3-close-audio" src="sound/bt.mp3" preload="auto"></audio>
<!-- Thêm audio cho nút phóng to/thu nhỏ popup -->
<audio id="popup-zoom-audio" src="sound/phongto.wav" preload="auto"></audio>
<audio id="popup-min-audio" src="sound/thunho.wav" preload="auto"></audio>
	<script>
    // Khởi tạo các biến popup trước khi dùng
    const customWindow = document.getElementById('cuaso1');
    const cuaso2 = document.getElementById('cuaso2');
    const cuaso3 = document.getElementById('cuaso3');

    // Đã xóa toàn bộ mã resize khỏi các popup
			// Nút nut1: hiệu ứng hạt + hiện/tắt popup + ẩn/hiện nut1 img
            const nut1 = document.getElementById('nut1');
            const nut1Img = nut1.querySelector('img');
            let popupVisible = false;
            const nut2 = document.getElementById('nut2');
            let cuaso2Visible = false;
            const nut3 = document.getElementById('nut3');
            let cuaso3Visible = false;
            // Chỉ mở popup khi click thực sự, không phải khi kéo/thả
            function isClickEvent(e, btn) {
                return e.type === 'click' && !btn._dragging;
            }

            nut1._dragging = false;
            nut1.addEventListener('mousedown', function(e) { nut1._dragging = false; });
            nut1.addEventListener('mousemove', function(e) { nut1._dragging = true; });
            nut1.addEventListener('click', function(e) {
                if (isClickEvent(e, nut1)) {
                    togglePopup(nut1, customWindow, 'popupVisible');
                    if (popupVisible) autoFitPopup(customWindow);
                }
                nut1._dragging = false;
            });
nut2.addEventListener('click', function(e) {
    if (isClickEvent(e, nut2)) {
        togglePopup(nut2, cuaso2, 'cuaso2Visible');
        if (cuaso2Visible) autoFitPopup(cuaso2);
    }
    nut2._dragging = false;
});
nut3.addEventListener('click', function(e) {
    if (isClickEvent(e, nut3)) {
        togglePopup(nut3, cuaso3, 'cuaso3Visible');
        if (cuaso3Visible) autoFitPopup(cuaso3);
    }
    nut3._dragging = false;
});

			// Kéo di chuyển cửa sổ custom
			const customHeader = document.getElementById('custom-header');
			let isDraggingCustom = false, offsetXCustom = 0, offsetYCustom = 0;
			customHeader.addEventListener('mousedown', function(e) {
                if (customWindow._isResizing) return;
                isDraggingCustom = true;
                offsetXCustom = e.clientX - customWindow.offsetLeft;
                offsetYCustom = e.clientY - customWindow.offsetTop;
                customHeader.style.cursor = 'grabbing';
			});
			document.addEventListener('mousemove', function(e) {
				if (isDraggingCustom) {
					customWindow.style.left = (e.clientX - offsetXCustom) + 'px';
					customWindow.style.top = (e.clientY - offsetYCustom) + 'px';
				}
			});
			document.addEventListener('mouseup', function() {
				isDraggingCustom = false;
				customHeader.style.cursor = 'move';
			});
			// Kéo di chuyển cửa sổ cuaso2
			const cuaso2Header = document.getElementById('cuaso2-header');
			let isDraggingCuaso2 = false, offsetXCuaso2 = 0, offsetYCuaso2 = 0;
			cuaso2Header.addEventListener('mousedown', function(e) {
                if (cuaso2._isResizing) return;
                isDraggingCuaso2 = true;
                offsetXCuaso2 = e.clientX - cuaso2.offsetLeft;
                offsetYCuaso2 = e.clientY - cuaso2.offsetTop;
                cuaso2Header.style.cursor = 'grabbing';
			});
			document.addEventListener('mousemove', function(e) {
				if (isDraggingCuaso2) {
					cuaso2.style.left = (e.clientX - offsetXCuaso2) + 'px';
					cuaso2.style.top = (e.clientY - offsetYCuaso2) + 'px';
				}
			});
			document.addEventListener('mouseup', function() {
				isDraggingCuaso2 = false;
				cuaso2Header.style.cursor = 'move';
			});
			// Kéo di chuyển cửa sổ cuaso3
			const cuaso3Header = document.getElementById('cuaso3-header');
			let isDraggingCuaso3 = false, offsetXCuaso3 = 0, offsetYCuaso3 = 0;
			cuaso3Header.addEventListener('mousedown', function(e) {
                if (cuaso3._isResizing) return;
                isDraggingCuaso3 = true;
                offsetXCuaso3 = e.clientX - cuaso3.offsetLeft;
                offsetYCuaso3 = e.clientY - cuaso3.offsetTop;
                cuaso3Header.style.cursor = 'grabbing';
			});
			document.addEventListener('mousemove', function(e) {
				if (isDraggingCuaso3) {
					cuaso3.style.left = (e.clientX - offsetXCuaso3) + 'px';
					cuaso3.style.top = (e.clientY - offsetYCuaso3) + 'px';
				}
			});
			document.addEventListener('mouseup', function() {
				isDraggingCuaso3 = false;
				cuaso3Header.style.cursor = 'move';
			});
			// Thêm hỗ trợ kéo cửa sổ bằng cảm ứng (touch) cho customWindow
			customHeader.addEventListener('touchstart', function(e) {
    if (e.touches.length === 1 && !customWindow._isResizing) {
        isDraggingCustom = true;
        offsetXCustom = e.touches[0].clientX - customWindow.offsetLeft;
        offsetYCustom = e.touches[0].clientY - customWindow.offsetTop;
        customHeader.style.cursor = 'grabbing';
    }
});
document.addEventListener('touchmove', function(e) {
    if (isDraggingCustom && e.touches.length === 1) {
        customWindow.style.left = (e.touches[0].clientX - offsetXCustom) + 'px';
        customWindow.style.top = (e.touches[0].clientY - offsetYCustom) + 'px';
    }
});
document.addEventListener('touchend', function() {
    isDraggingCustom = false;
    customHeader.style.cursor = 'move';
});
// Thêm hỗ trợ kéo cửa sổ bằng cảm ứng (touch) cho cuaso2
cuaso2Header.addEventListener('touchstart', function(e) {
    if (e.touches.length === 1 && !cuaso2._isResizing) {
        isDraggingCuaso2 = true;
        offsetXCuaso2 = e.touches[0].clientX - cuaso2.offsetLeft;
        offsetYCuaso2 = e.touches[0].clientY - cuaso2.offsetTop;
        cuaso2Header.style.cursor = 'grabbing';
    }
});
document.addEventListener('touchmove', function(e) {
    if (isDraggingCuaso2 && e.touches.length === 1) {
        cuaso2.style.left = (e.touches[0].clientX - offsetXCuaso2) + 'px';
        cuaso2.style.top = (e.touches[0].clientY - offsetYCuaso2) + 'px';
    }
});
document.addEventListener('touchend', function() {
    isDraggingCuaso2 = false;
    cuaso2Header.style.cursor = 'move';
});
// Thêm hỗ trợ kéo cửa sổ bằng cảm ứng (touch) cho cuaso3
cuaso3Header.addEventListener('touchstart', function(e) {
    if (e.touches.length === 1 && !cuaso3._isResizing) {
        isDraggingCuaso3 = true;
        offsetXCuaso3 = e.touches[0].clientX - cuaso3.offsetLeft;
        offsetYCuaso3 = e.touches[0].clientY - cuaso3.offsetTop;
        cuaso3Header.style.cursor = 'grabbing';
    }
});
document.addEventListener('touchmove', function(e) {
    if (isDraggingCuaso3 && e.touches.length === 1) {
        cuaso3.style.left = (e.touches[0].clientX - offsetXCuaso3) + 'px';
        cuaso3.style.top = (e.touches[0].clientY - offsetYCuaso3) + 'px';
    }
});
document.addEventListener('touchend', function() {
    isDraggingCuaso3 = false;
    cuaso3Header.style.cursor = 'move';
});
        // Kéo di chuyển nút nut1
        let isDraggingNut1 = false, offsetXNut1 = 0, offsetYNut1 = 0;
        nut1.addEventListener('mousedown', function(e) {
            isDraggingNut1 = true;
            offsetXNut1 = e.clientX - nut1.offsetLeft;
            offsetYNut1 = e.clientY - nut1.offsetTop;
            nut1.style.cursor = 'grabbing';
        });
        document.addEventListener('mousemove', function(e) {
            if (isDraggingNut1) {
                nut1.style.left = (e.clientX - offsetXNut1) + 'px';
                nut1.style.top = (e.clientY - offsetYNut1) + 'px';
                nut1.style.right = '';
                nut1.style.bottom = '';
                nut1.style.position = 'fixed';
            }
        });
        document.addEventListener('mouseup', function() {
            isDraggingNut1 = false;
            nut1.style.cursor = 'pointer';
        });
        // Kéo di chuyển nút nut2
        let isDraggingNut2 = false, offsetXNut2 = 0, offsetYNut2 = 0;
        nut2.addEventListener('mousedown', function(e) {
            isDraggingNut2 = true;
            offsetXNut2 = e.clientX - nut2.offsetLeft;
            offsetYNut2 = e.clientY - nut2.offsetTop;
            nut2.style.cursor = 'grabbing';
        });
        document.addEventListener('mousemove', function(e) {
            if (isDraggingNut2) {
                nut2.style.left = (e.clientX - offsetXNut2) + 'px';
                nut2.style.top = (e.clientY - offsetYNut2) + 'px';
                nut2.style.right = '';
                nut2.style.bottom = '';
                nut2.style.position = 'fixed';
                nut2.style.transform = '';
            }
        });
        document.addEventListener('mouseup', function() {
            isDraggingNut2 = false;
            nut2.style.cursor = 'pointer';
        });
        // Kéo di chuyển nút nut3
        let isDraggingNut3 = false, offsetXNut3 = 0, offsetYNut3 = 0;
        nut3.addEventListener('mousedown', function(e) {
            isDraggingNut3 = true;
            offsetXNut3 = e.clientX - nut3.offsetLeft;
            offsetYNut3 = e.clientY - nut3.offsetTop;
            nut3.style.cursor = 'grabbing';
        });
        document.addEventListener('mousemove', function(e) {
            if (isDraggingNut3) {
                nut3.style.left = (e.clientX - offsetXNut3) + 'px';
                nut3.style.top = (e.clientY - offsetYNut3) + 'px';
                nut3.style.right = '';
                nut3.style.bottom = '';
                nut3.style.position = 'fixed';
            }
        });
        document.addEventListener('mouseup', function() {
            isDraggingNut3 = false;
            nut3.style.cursor = 'pointer';
        });
        // Hỗ trợ kéo bằng cảm ứng cho nut1
        nut1.addEventListener('touchstart', function(e) {
            if (e.touches.length === 1) {
                isDraggingNut1 = true;
                offsetXNut1 = e.touches[0].clientX - nut1.offsetLeft;
                offsetYNut1 = e.touches[0].clientY - nut1.offsetTop;
                nut1.style.cursor = 'grabbing';
            }
        });
        document.addEventListener('touchmove', function(e) {
            if (isDraggingNut1 && e.touches.length === 1) {
                nut1.style.left = (e.touches[0].clientX - offsetXNut1) + 'px';
                nut1.style.top = (e.touches[0].clientY - offsetYNut1) + 'px';
                nut1.style.right = '';
                nut1.style.bottom = '';
                nut1.style.position = 'fixed';
            }
        });
        document.addEventListener('touchend', function() {
            isDraggingNut1 = false;
            nut1.style.cursor = 'pointer';
        });
        // Hỗ trợ kéo bằng cảm ứng cho nut2
        nut2.addEventListener('touchstart', function(e) {
            if (e.touches.length === 1) {
                isDraggingNut2 = true;
                offsetXNut2 = e.touches[0].clientX - nut2.offsetLeft;
                offsetYNut2 = e.touches[0].clientY - nut2.offsetTop;
                nut2.style.cursor = 'grabbing';
            }
        });
        document.addEventListener('touchmove', function(e) {
            if (isDraggingNut2 && e.touches.length === 1) {
                nut2.style.left = (e.touches[0].clientX - offsetXNut2) + 'px';
                nut2.style.top = (e.touches[0].clientY - offsetYNut2) + 'px';
                nut2.style.right = '';
                nut2.style.bottom = '';
                nut2.style.position = 'fixed';
                nut2.style.transform = '';
            }
        });
        document.addEventListener('touchend', function() {
            isDraggingNut2 = false;
            nut2.style.cursor = 'pointer';
        });
        // Hỗ trợ kéo bằng cảm ứng cho nut3
        nut3.addEventListener('touchstart', function(e) {
            if (e.touches.length === 1) {
                isDraggingNut3 = true;
                offsetXNut3 = e.touches[0].clientX - nut3.offsetLeft;
                offsetYNut3 = e.touches[0].clientY - nut3.offsetTop;
                nut3.style.cursor = 'grabbing';
            }
        });
        document.addEventListener('touchmove', function(e) {
            if (isDraggingNut3 && e.touches.length === 1) {
                nut3.style.left = (e.touches[0].clientX - offsetXNut3) + 'px';
                nut3.style.top = (e.touches[0].clientY - offsetYNut3) + 'px';
                nut3.style.right = '';
                nut3.style.bottom = '';
                nut3.style.position = 'fixed';
            }
        });
        document.addEventListener('touchend', function() {
            isDraggingNut3 = false;
            nut3.style.cursor = 'pointer';
        });
// Rút gọn JS cho nút
function togglePopup(btn, popup, visibleVar) {
    window[visibleVar] = !window[visibleVar];
    if (window[visibleVar]) {
        zoomPopup(popup, true);
    } else {
        zoomPopup(popup, false);
    }
}

// Đảm bảo phát âm thanh tức thì, không bị delay hoặc lỗi promise
function playAudioInstant(id) {
    var audio = document.getElementById(id);
    if (!audio) return;
    try {
        audio.pause();
        audio.currentTime = 0;
        var playPromise = audio.play();
        if (playPromise !== undefined) {
            playPromise.catch(function(){});
        }
    } catch(e) {}
}
// Nút thu nhỏ/mở rộng cho customWindow
function animateButton(btn, callback) {
    btn.style.transition = 'box-shadow 0.2s, transform 0.15s, background 0.15s';
    btn.style.boxShadow = '0 1px 8px rgba(0,0,0,0.22)';
    btn.style.transform = 'scale(0.96)';
    btn.style.background = '#e0e0e0';
    setTimeout(function() {
        btn.style.boxShadow = '';
        btn.style.transform = '';
        btn.style.background = '';
        if (callback) callback();
    }, 160);
}
document.getElementById('custom-min').onclick = function() {
    animateButton(this, function() {
        var content = customWindow.querySelector('.popup-content');
        if (!content || !content.innerHTML.trim()) {
            zoomPopup(customWindow, false);
            popupVisible = false;
            return;
        }
        customWindow.style.transition = 'transform 0.38s cubic-bezier(.4,1.6,.3,1)';
        customWindow.style.transform = 'scale(0.75)';
        setTimeout(function() {
            customWindow.style.width = (300 * 0.75) + 'px';
            customWindow.style.height = (400 * 0.75) + 'px';
            customWindow.style.transform = 'scale(1)';
            document.getElementById('custom-min').style.boxShadow = '0 0 0 4px #222, 0 0 8px 2px #7ed6fa';
            document.getElementById('custom-max').style.boxShadow = '';
        }, 320);
    });
};
document.getElementById('custom-max').onclick = function() {
    animateButton(this, function() {
        customWindow.style.transition = 'transform 0.38s cubic-bezier(.4,1.6,.3,1)';
        customWindow.style.transform = 'scale(2)';
        setTimeout(function() {
            customWindow.style.width = '600px';
            customWindow.style.height = '800px';
            customWindow.style.transform = 'scale(1)';
            document.getElementById('custom-max').style.boxShadow = '0 0 0 4px #222, 0 0 8px 2px #7ed6fa';
            document.getElementById('custom-min').style.boxShadow = '';
        }, 320);
    });
};
document.getElementById('cuaso2-min').onclick = function() {
    animateButton(this, function() {
        var content = cuaso2.querySelector('.popup-content');
        if (!content || !content.innerHTML.trim()) {
            zoomPopup(cuaso2, false);
            cuaso2Visible = false;
            return;
        }
        cuaso2.style.transition = 'transform 0.38s cubic-bezier(.4,1.6,.3,1)';
        cuaso2.style.transform = 'scale(0.75)';
        setTimeout(function() {
            cuaso2.style.width = (300 * 0.75) + 'px';
            cuaso2.style.height = (400 * 0.75) + 'px';
            cuaso2.style.transform = 'scale(1)';
            document.getElementById('cuaso2-min').style.boxShadow = '0 0 0 4px #222, 0 0 8px 2px #7ed6fa';
            document.getElementById('cuaso2-max').style.boxShadow = '';
        }, 320);
    });
};
document.getElementById('cuaso2-max').onclick = function() {
    animateButton(this, function() {
        cuaso2.style.transition = 'transform 0.38s cubic-bezier(.4,1.6,.3,1)';
        cuaso2.style.transform = 'scale(2)';
        setTimeout(function() {
            cuaso2.style.width = '600px';
            cuaso2.style.height = '800px';
            cuaso2.style.transform = 'scale(1)';
            document.getElementById('cuaso2-max').style.boxShadow = '0 0 0 4px #222, 0 0 8px 2px #7ed6fa';
            document.getElementById('cuaso2-min').style.boxShadow = '';
        }, 320);
    });
};
document.getElementById('cuaso3-min').onclick = function() {
    animateButton(this, function() {
        var content = cuaso3.querySelector('.popup-content');
        if (!content || !content.innerHTML.trim()) {
            zoomPopup(cuaso3, false);
            cuaso3Visible = false;
            return;
        }
        cuaso3.style.transition = 'transform 0.38s cubic-bezier(.4,1.6,.3,1)';
        cuaso3.style.transform = 'scale(0.75)';
        setTimeout(function() {
            cuaso3.style.width = (300 * 0.75) + 'px';
            cuaso3.style.height = (400 * 0.75) + 'px';
            cuaso3.style.transform = 'scale(1)';
            document.getElementById('cuaso3-min').style.boxShadow = '0 0 0 4px #222, 0 0 8px 2px #7ed6fa';
            document.getElementById('cuaso3-max').style.boxShadow = '';
        }, 320);
    });
};
document.getElementById('cuaso3-max').onclick = function() {
    animateButton(this, function() {
        cuaso3.style.transition = 'transform 0.38s cubic-bezier(.4,1.6,.3,1)';
        cuaso3.style.transform = 'scale(2)';
        setTimeout(function() {
            cuaso3.style.width = '600px';
            cuaso3.style.height = '800px';
            cuaso3.style.transform = 'scale(1)';
            document.getElementById('cuaso3-max').style.boxShadow = '0 0 0 4px #222, 0 0 8px 2px #7ed6fa';
            document.getElementById('cuaso3-min').style.boxShadow = '';
        }, 320);
    });
};
// Đã xử lý ở trên: popup chỉ mở khi click thực sự, không phải khi kéo/thả nút

// Tự động căn chỉnh popup để hiển thị đầy đủ thông tin
function autoFitPopup(popup) {
    // Lấy phần nội dung
    var content = popup.querySelector('.popup-content');
    if (!content) return;
    // Đặt lại width/height về auto để đo
    popup.style.width = '';
    popup.style.height = '';
    // Đo kích thước nội dung
    var rect = content.getBoundingClientRect();
    var header = popup.querySelector('.popup-header');
    var headerH = header ? header.offsetHeight : 0;
    var minW = 300, minH = 120;
    var padW = 32, padH = 32;
    var newW = Math.max(minW, rect.width + padW);
    var newH = Math.max(minH, rect.height + headerH + padH);
    popup.style.width = newW + 'px';
    popup.style.height = newH + 'px';
}

// Hiệu ứng thu phóng khi đóng/mở popup
function zoomPopup(popup, show, callback) {
    popup.style.transition = 'transform 0.32s cubic-bezier(.4,1.6,.3,1), opacity 0.22s';
    // Phát âm thanh khi mở/tắt popup không bị delay
    if (popup === customWindow) {
        if (show) playAudioInstant('popup1-open-audio');
        else playAudioInstant('popup1-close-audio');
    }
    if (popup === cuaso2) {
        if (show) playAudioInstant('popup2-open-audio');
        else playAudioInstant('popup2-close-audio');
    }
    if (popup === cuaso3) {
        if (show) playAudioInstant('popup3-open-audio');
        else playAudioInstant('popup3-close-audio');
    }
    if (show) {
        popup.style.display = 'block';
        popup.style.opacity = '0';
        popup.style.transform = 'scale(0.85)';
        setTimeout(function() {
            popup.style.opacity = '1';
            popup.style.transform = 'scale(1)';
            if (callback) callback();
        }, 10);
    } else {
        popup.style.opacity = '0';
        popup.style.transform = 'scale(0.85)';
        setTimeout(function() {
            popup.style.display = 'none';
            popup.style.transform = 'scale(1)';
            if (callback) callback();
        }, 220);
    }
}
// Thêm âm thanh khi bấm nút phóng to/thu nhỏ trong popup
['custom-min','custom-max','cuaso2-min','cuaso2-max','cuaso3-min','cuaso3-max'].forEach(function(id) {
    const btn = document.getElementById(id);
    if (!btn) return;
    btn.addEventListener('click', function() {
        if (id.endsWith('max')) playAudioInstant('popup-zoom-audio');
        if (id.endsWith('min')) playAudioInstant('popup-min-audio');
    }, true);
});
const nut4 = document.getElementById('nut4');
let nut4Zoomed = false;
let nut4Dragging = false;
let nut4DragStarted = false;
let nut4OffsetX = 0, nut4OffsetY = 0;
let nut4MapWidth = window.innerWidth - 240;
let nut4MapHeight = window.innerHeight - 240;
let nut4Center = () => {
    const winW = window.innerWidth;
    const winH = window.innerHeight;
    nut4.style.left = (winW/2 - 110) + 'px';
    nut4.style.top = (winH/2 - 110) + 'px';
};
// Di chuyển nut4 bằng chuột
nut4.addEventListener('mousedown', function(e) {
    nut4Dragging = true;
    nut4DragStarted = false;
    nut4OffsetX = e.clientX - nut4.offsetLeft;
    nut4OffsetY = e.clientY - nut4.offsetTop;
    nut4.style.transition = 'none';
});
document.addEventListener('mousemove', function(e) {
    if (nut4Dragging) {
        nut4DragStarted = true;
        let maxW = nut4Zoomed ? window.innerWidth - 220 : nut4MapWidth;
        let maxH = nut4Zoomed ? window.innerHeight - 220 : nut4MapHeight;
        let x = Math.max(0, Math.min(maxW, e.clientX - nut4OffsetX));
        let y = Math.max(0, Math.min(maxH, e.clientY - nut4OffsetY));
        nut4.style.left = x + 'px';
        nut4.style.top = y + 'px';
    }
});
document.addEventListener('mouseup', function(e) {
    nut4Dragging = false;
    nut4.style.transition = '';
});
nut4.addEventListener('click', function(e) {
    if (nut4DragStarted) return;
    if (!nut4Zoomed) {
        document.getElementById('nut4-audio').play();
        nut4Zoomed = true;
        nut4.style.transition = 'width 0.38s, height 0.38s, left 0.38s, top 0.38s';
        nut4.style.width = '360px';
        nut4.style.height = '640px';
        nut4.style.zIndex = '10000';
        nut4.style.background = 'none';
        nut4.style.border = 'none';
        nut4.style.boxShadow = 'none';
        nut4Center();
        nut4.innerHTML = '<img id="nut4img" src="pic/QR.png" alt="Secret" style="width:100%; height:100%; object-fit:cover; user-select:none; pointer-events:none; background:none; border-radius:18px; border:4px solid #fff; box-shadow:0 0 32px 8px #fff, 0 0 8px 2px #fff;">';
    } else {
        nut4Zoomed = false;
        nut4.style.transition = 'width 0.38s, height 0.38s, left 0.38s, top 0.38s';
        nut4.style.width = '40px';
        nut4.style.height = '40px';
        nut4.style.zIndex = '1000';
        nut4.style.background = '#eee';
        nut4.style.border = '';
        nut4.style.boxShadow = '0 0 8px #aaa';
        nut4.innerHTML = '<img src="pic/phpls.png" alt="Hidden" style="width:100%; height:100%; border-radius:50%; pointer-events:none; user-select:none;">';
    }
});
// Đặt vị trí ngẫu nhiên cho nut4 khi load trang
window.addEventListener('DOMContentLoaded', function() {
    const nut4 = document.getElementById('nut4');
    let nut4MapWidth = window.innerWidth - 40;
    let nut4MapHeight = window.innerHeight - 40;
    let x = Math.floor(Math.random() * nut4MapWidth);
    let y = Math.floor(Math.random() * nut4MapHeight);
    nut4.style.left = x + 'px';
    nut4.style.top = y + 'px';
});
window.addEventListener('resize', function() {
    nut4MapWidth = window.innerWidth - 240;
    nut4MapHeight = window.innerHeight - 240;
});
// Dịch chuyển ngẫu nhiên mỗi 5 giây
setInterval(function() {
    if (!nut4Zoomed) {
        let x = Math.floor(Math.random() * nut4MapWidth);
        let y = Math.floor(Math.random() * nut4MapHeight);
        nut4.style.left = x + 'px';
        nut4.style.top = y + 'px';
    }
}, 5000);
    // Thêm di chuyển cảm ứng cho nut4 (touch drag)
    // Sử dụng biến nut4 đã có ở trên
    let touchStartX = 0, touchStartY = 0, startLeft = 0, startTop = 0, isDragging = false;
    nut4.addEventListener('touchstart', function(e) {
        if (e.touches.length === 1) {
            isDragging = true;
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            startLeft = parseInt(nut4.style.left || nut4.offsetLeft);
            startTop = parseInt(nut4.style.top || nut4.offsetTop);
            nut4.style.transition = 'none';
        }
    });
    nut4.addEventListener('touchmove', function(e) {
        if (isDragging && e.touches.length === 1) {
            let dx = e.touches[0].clientX - touchStartX;
            let dy = e.touches[0].clientY - touchStartY;
            nut4.style.left = (startLeft + dx) + 'px';
            nut4.style.top = (startTop + dy) + 'px';
            e.preventDefault();
        }
    }, {passive:false});
    nut4.addEventListener('touchend', function(e) {
        isDragging = false;
        nut4.style.transition = '';
    });
	</script>
</body>
</html>
